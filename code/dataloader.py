"""
Docstring for dataloader.py
"""

import torch
import torch.utils.data

import dataset
from config import configurate
from config import config

def main(conf):
    print(conf)

    example_sentences = [66, 23, 12]
    data = dataset.CustomDataset(conf)
    batch = [data[i] for i in example_sentences]
    custom_collate(batch)

def custom_collate(batch):
    """
    Function takes samples given by CustomDataset and creates batches to be fed into the model

    Parameters
    ---------
    batch : list
        A single batch to be collated. Batch consists of tuples (words, labels) generated by CustomDataset
    """

    max_sentence_length = max(map(lambda x: len(x), batch[:][0])) # batch[:][0] gives a list of all list of words
    max_word_length = max([max(map(lambda x: len(x), sentence)) for sentence in batch[:][0]])
    for words, _ in batch:
        for word in words:
            word += [pad_id] * (max_word_length - len(word))
        words += [pad_id] * (max_sentence_length - len(words))
    # don't forget to turn this into tensors
    # return data.default_collate(batch)


if __name__ == "__main__":
    configurate()
    pad_id = -1  # for now, have to fix it later
    main(config)
